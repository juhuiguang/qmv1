[
	{ "keywords":"AllCq" ,  
	"selectsql":"SELECT tb5.allcq,tb3.dep_name,tb3.maxcq, tb4.dep_name dep_name1,tb4.mincq FROM (SELECT ROUND(AVG(radio),2) allcq FROM  (SELECT tb1.dep_name,ROUND(AVG(check_ratio),2) AS radio FROM(SELECT a.`check_ratio`,a.`check_count`,e.`dep_name`   FROM qm_stu_check_main a , base_task_sche b ,base_teach_task c ,base_department e,base_classes f  WHERE a.`sche_no`=b.`sche_no` AND b.`task_no`=c.`task_no` AND a.`check_main_status`=''1''  AND a.`term_no`=''{1}'' AND c.`class_no`=f.`class_no`  AND f.`dep_no`=e.`dep_no`)tb1   LEFT JOIN base_department f ON tb1.dep_name=f.`dep_name`  GROUP BY tb1.dep_name,f.dep_no  ORDER BY radio DESC)tb2)tb5 , (SELECT tb1.dep_name,ROUND(AVG(check_ratio),2) AS maxcq FROM(SELECT a.`check_ratio`,a.`check_count`,e.`dep_name`   FROM qm_stu_check_main a , base_task_sche b ,base_teach_task c ,base_department e,base_classes f  WHERE a.`sche_no`=b.`sche_no` AND b.`task_no`=c.`task_no` AND a.`check_main_status`=''1''  AND a.`term_no`=''1'' AND c.`class_no`=f.`class_no`  AND f.`dep_no`=e.`dep_no`)tb1   LEFT JOIN base_department f ON tb1.dep_name=f.`dep_name`  GROUP BY tb1.dep_name,f.dep_no  ORDER BY maxcq DESC LIMIT 0,1)tb3 , (SELECT tb1.dep_name,ROUND(AVG(check_ratio),2) AS mincq FROM(SELECT a.`check_ratio`,a.`check_count`,e.`dep_name`   FROM qm_stu_check_main a , base_task_sche b ,base_teach_task c ,base_department e,base_classes f  WHERE a.`sche_no`=b.`sche_no` AND b.`task_no`=c.`task_no` AND a.`check_main_status`=''1''  AND a.`term_no`=''{1}'' AND c.`class_no`=f.`class_no`  AND f.`dep_no`=e.`dep_no`)tb1   LEFT JOIN base_department f ON tb1.dep_name=f.`dep_name`  GROUP BY tb1.dep_name,f.dep_no   ORDER BY mincq ASC LIMIT 0,1)tb4" ,"datatemplate":"出勤情况：当前全校平均出勤率【$$(allcq)%】，其中$$(dep_name)出勤率最高【$$(maxcq)%】，$$(dep_name1)出勤率偏低【$$(mincq)】","circulate":"0","circualsql":"","circulatedata":"","datacirtual":"","errmessage":" " },
    { "keywords":"master_listen" ,  "selectsql":"SELECT tb2.tkjs,tb3.tkcs FROM  (SELECT COUNT(*) tkjs FROM (SELECT a.listen_no FROM `qm_master_listen` a,`qm_master` b WHERE a.teacher_no = b.teacher_no AND a.`listen_time` BETWEEN ''{0}''   AND ''{1}'' GROUP BY a.teacher_no) tb1)tb2, (SELECT COUNT(*) tkcs FROM `qm_master_listen` a,`qm_master` b WHERE a.teacher_no = b.teacher_no AND a.`listen_time` BETWEEN ''{0}''   AND ''{1}'') tb3" ,"datatemplate":"本周共有【$$(tkjs)】位督学听课了【$$(tkcs)】次","circulate":"0","circualsql":"","circulatedata":"","datacirtual":"","errmessage":" " },
    { "keywords":"master_plan" ,  "selectsql":"SELECT tb2.jhjs,tb3.sjcs FROM (SELECT COUNT(*) jhjs FROM (SELECT a.teacher_no,a.plan_time FROM `qm_master_listen_plan` a LEFT JOIN `qm_master` b ON  a.teacher_no = b.teacher_no AND b.master_type='校级督学'  WHERE a.`plan_time` BETWEEN ''{0}'' AND ''{1}'') tb1) tb2, (SELECT COUNT(*) sjcs FROM  (SELECT c.teacher_no FROM   (SELECT a.teacher_no,a.plan_time FROM `qm_master_listen_plan` a LEFT JOIN `qm_master` b ON  a.teacher_no = b.teacher_no AND b.master_type='校级督学'  WHERE a.`plan_time` BETWEEN ''{0}'' AND ''{1}'') tb1 LEFT JOIN `qm_master_listen` c ON c.teacher_no = tb1.teacher_no WHERE FLOOR(DATEDIFF(c.`listen_time`,'1900-01-01')/7) = FLOOR(DATEDIFF(tb1.plan_time,'1900-01-01')/7) GROUP BY task_no) tb2)tb3" ,"datatemplate":"本周校督导的听课计划共【$$(jhjs)】次，已完成【$$(sjcs)】次","circulate":"0","errmessage":" " },
    { "keywords":"attendance_warning" ,  "selectsql":"SELECT COUNT(*) rs FROM( SELECT COUNT(*)AS cs FROM qm_stu_check WHERE check_time>''{0}'' AND check_time<''{1}'' AND check_status<>'请假' GROUP BY stu_no HAVING cs>''{2}'')tb2" ,"datatemplate":"截止到今天，已经有【$$()】位同学缺勤超过预警值","circulate":"0","errmessage":" " },
    { "keywords":"class_attendance" ,  "selectsql":"SELECT d.`class_name`,ROUND(AVG(a.`check_ratio`),2) AS ratio FROM qm_stu_check_main a ,base_task_sche b ,base_teach_task c,base_classes d WHERE a.`sche_no` = b.`sche_no`  AND b.`task_no` =c.`task_no`  AND a.`check_main_status`=''1''  AND c.`class_no` = ''{0}''  AND a.`term_no`=''{1}''  AND c.`class_no`=d.`class_no` AND a.`check_week` = ''{2}''" ,"datatemplate":"【$$(class_name)】本周出勤率【$$(ratio)%】","circulate":"0","errmessage":"" },
    { "keywords":"inspection_report" ,  "selectsql":"SELECT report_stuattendance,report_stustudy,report_teateach,report_teachsecurity,report_other FROM `qm_patrol_report` WHERE term_no = ''{0}'' ORDER BY  report_time DESC LIMIT 0,1" ,"datatemplate":"最新巡查报告结果，巡查记录学生出勤情况：$$(report_stuattendance),巡查记录学生学习情况:$$(report_stustudy),巡查记录教师教学情况:$$(report_teateach),巡查记录教学管理情况:$$(report_teachmanage),巡查记录教学条件保障:$$(report_teachsecurity),巡查记录其他情况:$$(report_other)","circulate":"0","errmessage":"本学期暂没有巡查报告" },
  	{ "keywords":"teacher_listen" ,  "selectsql":"SELECT  tb3.no_listencount,tb2.listencount FROM (SELECT COUNT(*) listencount FROM( SELECT COUNT(tb1.teacher_no) listencount FROM `base_teacher` a LEFT JOIN  (SELECT b.teacher_no FROM `qm_master_listen` a  LEFT JOIN `base_teach_task` b ON a.task_no = b.`task_no`  WHERE b.term_no = ''{0}'') tb1 ON tb1.teacher_no = a.teacher_no  GROUP BY a.teacher_no HAVING listencount>0) tb1)tb2, (SELECT COUNT(*) no_listencount FROM( SELECT COUNT(tb1.teacher_no) listencount FROM `base_teacher` a LEFT JOIN  (SELECT b.teacher_no FROM `qm_master_listen` a LEFT JOIN `base_teach_task` b ON a.task_no = b.`task_no` WHERE b.term_no = ''{0}'') tb1 ON tb1.teacher_no = a.teacher_no  GROUP BY a.teacher_no HAVING listencount=0)tb2)tb3" ,"datatemplate":"到今天为止有【$$(listencount)】位教师被听过1次课以上，未被听过课程的老师有【$$(no_listencount)】人。","circulate":"0","errmessage":"" },
    { "keywords":"inspection_report" , selectsql:"","circulate":"0","errmessage":"" },
    { "keywords":"inspection_report" ,  selectsql:"","circulate":"0","errmessage":"" }
]

